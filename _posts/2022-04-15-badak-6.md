---
title:  "합성곱 신경망(CNN)" 

categories:
  - Basic
tags:
  - [Programming, Python]

toc: true
toc_sticky: true

date: 2022-04-14
last_modified_at: 2022-04-14
---

밑바닥부터 시작하는 딥러닝 책을 공부한 내용을 토대로 작성한 글입니다.

<br>

# Chapter 5. Convolution Neural Network

이번에 배울 CNN은 이미지 인식과 음성 인식 등 다양한 곳에서 사용되는데, 특히 이미지 인식 분야에서 딥러닝을 활용한 기법은 거의 다 CNN을 기초로한다. 이번엔 CNN의 이론을 살펴보고 파이썬으로 구현해보자.

## 5.1 CNN이란?

우선 CNN을 이해하기 위해서 네트워크 구조를 살펴보며 전체 틀을 이해해보자. CNN도 지금까지의 신경망과 같이 레고 블록처럼 계층을 조합하여 만들수 있다. 다만, 합성곱 계층(Convolution Layer)과 풀링 계층(Pooling Layer)이 새롭게 등장한다. 지금까지의 신경망은 인접하는 계층의 모든 뉴런과 결합되어 있었는데 이를 완전연결 계층(Fully Connected Layer)이라고 하며 이러한 구조를 Affine 계층이라는 이름으로 구현했었다. 이 Affine 계층을 사용하면 가령 층이 5개인 완전연결 신경망은 아래와 같이 구현할 수 있다.

![img6-1](/assets/images/badak/fig%207-1.png)

위 그림과 같이 완전연결 신경망은 Affine 계층 뒤에 활성화 함수를 갖는 ReLU 계층이 이어지며 이 그림에서는  Affine-ReLU 조합이 4개가 있으며 마지막 5번째 층은 Affine 계층에 이어 소프트맥스 계층에서 최종 결과를 출력한다. 그럼 CNN의 구조는 어떻게 다를까? 아래 그림은 CNN의 예이다.

![img6-2](/assets/images/badak/fig%207-2.png)

CNN에서는 합성곱 계층과 풀링 계층이 추가된다. CNN의 계층은 보통 Conv-ReLU-Pooling의 흐름으로 연결되며 지금까지의 Affine-ReLU가 Conv-ReLU-Pooling으로 바뀌었다고 생각하면된다. 또한 CNN에서 주목할 점은 출력에 가까운 층에서는 지금까지의 Affine-ReLU의 구성을 사용할 수 있다는 것이다.

## 5.2 합성곱 계층

CNN에서는 패딩(padding), 스트라이드(stride)등 CNN 고유의 용어가 등장한다. 또, 각 계층 사이에는 3차원 데이터같이 입체적인 데이터가 흐른다는 점에서 완전연결 신경망과 다르다. 지금까지 본 완전연결 신경망에서는 완전연결 계층을 사용했다. 완전연결 계층에서는 인접하는 계층의 뉴런이 모두 연결되고 출력의 수는 임의로 정할 수 있다. 이러한 완전연결 계층의 문제점은 데이터의 형상이 무시된다는 것이다. 입력 데이터가 이미지인 경우를 예로 들면 이미지는 통상 세로, 가로, 채널로 구성된 3차원 데이터이다. 그러나 완전연결 계층에 입력할 때는 3차원 데이터를 평평한 1차원 데이터로 평탄화해줘야 한다.

이미지는 3차원 형상이며, 이 형상에는 소중한 공간적 정보가 담겨 있다. 예를 들어 공간적으로 가까운 픽셀은 값이 비슷하거나, RGB의 각 채널은 서로 밀접하게 관련되어 있거나, 거리가 먼 픽셀끼리는 별 연관이 없는 등, 3차원 속에서 의미를 갖는 본질적인 패턴이 숨어 있을 것입니다. 그러나 완전연결 계층은 형상을 무시하고 모든 입력 데이터를 동등한 뉴런으로 취급하여 형상에 담긴 정보를 살릴 수 없다.

한편, 합성공 계층은 형상을 유지하며 이미지도 3차원 데이터로 입력받으며, 마찬가지로 다음 계층에도 3차원 데이터로 전달한다. 그래서 CNN은 이미지처럼 형상을 가진 데이터를 제대로 이해할 수 있다.
